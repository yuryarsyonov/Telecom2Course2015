#HTTP-сервер

##Индивидуальное задание

Разработать приложение, реализовывающее функции HTTP-сервера.
Приложение должно реализовывать следующие функции:

1. Обработка подключения клиента

2. Разбор строки URL

3. Выдача клиенту запрошенного ресурса

4. Обеспечение парралельной работы нескольких клиентов

5. Отображение параметров, принимемых методом POST

6. Формирование необходимых заголовков протокола HTTP

7. Протоколирование работы сервера

##Теоритические сведения протокола SMTP

###Сведения о протоколе

HTTP (англ. HyperText Transfer Protocol — «протокол передачи гипертекста») — протокол прикладного уровня передачи данных (изначально — в виде гипертекстовых документов в формате HTML, в настоящий момент используется для передачи произвольных данных). Основой HTTP является технология «клиент-сервер», то есть предполагается существование потребителей (клиентов), которые инициируют соединение и посылают запрос, и поставщиков (серверов), которые ожидают соединения для получения запроса, производят необходимые действия и возвращают обратно сообщение с результатом.

HTTP в настоящее время повсеместно используется во Всемирной паутине для получения информации с веб-сайтов. В 2006 году в Северной Америке доля HTTP-трафика превысила долю P2P-сетей и составила 46 %, из которых почти половина — это передача потокового видео и звука.

HTTP используется также в качестве «транспорта» для других протоколов прикладного уровня, таких как SOAP, XML-RPC, WebDAV.

Основным объектом манипуляции в HTTP является ресурс, на который указывает URI (Universal Resource Identifier) в запросе клиента. Обычно такими ресурсами являются хранящиеся на сервере файлы, но ими могут быть логические объекты или что-то абстрактное. Особенностью протокола HTTP является возможность указать в запросе и ответе способ представления одного и того же ресурса по различным параметрам: формату, кодировке, языку и т. д. (В частности для этого используется HTTP-заголовок.) Именно благодаря возможности указания способа кодирования сообщения клиент и сервер могут обмениваться двоичными данными, хотя данный протокол является текстовым.

HTTP — протокол прикладного уровня, аналогичными ему являются FTP и SMTP. Обмен сообщениями идёт по обыкновенной схеме «запрос-ответ». Для идентификации ресурсов HTTP использует глобальные URI. В отличие от многих других протоколов, HTTP не сохраняет своего состояния. Это означает отсутствие сохранения промежуточного состояния между парами «запрос-ответ». Компоненты, использующие HTTP, могут самостоятельно осуществлять сохранение информации о состоянии, связанной с последними запросами и ответами (например, «куки» на стороне клиента, «сессии» на стороне сервера). Браузер, посылающий запросы, может отслеживать задержки ответов. Сервер может хранить IP-адреса и заголовки запросов последних клиентов. Однако сам протокол не осведомлён о предыдущих запросах и ответах, в нём не предусмотрена внутренняя поддержка состояния, к нему не предъявляются такие требования.

###Реализуемые методы

1. **GET** - Используется для запроса содержимого указанного ресурса. С помощью метода GET можно также начать какой-либо процесс. В этом случае в тело ответного сообщения следует включить информацию о ходе выполнения процесса.

2. **HEAD** - Аналогичен методу GET, за исключением того, что в ответе сервера отсутствует тело. Запрос HEAD обычно применяется для извлечения метаданных, проверки наличия ресурса (валидация URL) и чтобы узнать, не изменился ли он с момента последнего обращения.

3. **POST** - Применяется для передачи пользовательских данных заданному ресурсу. Например, в блогах посетители обычно могут вводить свои комментарии к записям в HTML-форму, после чего они передаются серверу методом POST и он помещает их на страницу. При этом передаваемые данные (в примере с блогами — текст комментария) включаются в тело запроса. Аналогично с помощью метода POST обычно загружаются файлы на сервер. 

4. **PUT** - Применяется для загрузки содержимого запроса на указанный в запросе URI. Если по заданному URI не существовало ресурса, то сервер создаёт его и возвращает статус 201 (Created).

###Коды сообщений

1. **200 (OK)** - данный код сигнализирует об успешном выполнении какого-либо запроса к серверу.

2. **404 (Not Found)** - данный код сигнализиует о том, что запрошенный ресурс не был найден.

3. **405 (Method Not Allowed)** - данный код сигнализиует о том, что запрошенный метод не релизован на сервере.

4. **500 (Internal Server Error)** - код внутренней ошибки сервера

5. **400 (Bad Request)** - код сигнализирующий о поврежденном (некорректном) запросе.

##Архитектура приложения

Приложение состоит из трех классов: 

1. **Request** - класс, осуществляющий обработку запросов от клиентов.

2. **Response** - класс, осуществляющий отправку ответов.

3. **MyTCPHandler** - основной клас, реализующий функциональность сервера.

###Класс Request

1. **fetch_post_params** - обработка POST запроса и отправка ответа.

2. **send** - запись ответа в сокет и его отправка.

3. **get_path** - выделение адреса требуемого файла из запроса

###Класс Response

1. **form_message** - сборка ответа для отправки.

2. **send** - запись ответа в сокет и его отправка.


##Дизайн приложения

После запуска к стартовой странице сервера можно обратиться по адресу http//localhost:8080/ и начать работу с установленным на него сайтом.

##Тестирование приложения

Для тестирования приложения были написаны unit тесты.
Задавая определенные параметры входных значений, проверим работу отдельных функций, таких как установление соединения, аутентификация клиента, отправка сообщения, разрыв соединения.
Листинг unit тестов приведен в приложении.

